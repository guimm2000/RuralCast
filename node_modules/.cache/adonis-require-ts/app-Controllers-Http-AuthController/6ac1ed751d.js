"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const LoginValidator_1 = __importDefault(global[Symbol.for('ioc.use')]("App/Validators/LoginValidator"));
class AuthController {
    async create({ view }) {
        return view.render('auth/create');
    }
    async store({ auth, response, request, session }) {
        const payload = await request.validate(LoginValidator_1.default);
        try {
            await auth.use('web').attempt(payload.email, payload.password);
        }
        catch {
            session.flash('Erro de login', 'erro');
            return response.redirect().toRoute('auth.create');
        }
        return response.redirect().toRoute('home');
    }
    async destroy({ auth, response }) {
        await auth.use('web').logout();
        return response.redirect().toRoute('auth.create');
    }
}
exports.default = AuthController;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXV0aENvbnRyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJBdXRoQ29udHJvbGxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUNBLHlHQUEwRDtBQUUxRCxNQUFxQixjQUFjO0lBQzNCLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBRSxJQUFJLEVBQXVCO1FBQ2hELE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQTtJQUNsQyxDQUFDO0lBRU0sS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBdUI7UUFDeEUsTUFBTSxPQUFPLEdBQUcsTUFBTSxPQUFPLENBQUMsUUFBUSxDQUFDLHdCQUFjLENBQUMsQ0FBQTtRQUV0RCxJQUFJO1lBQ0YsTUFBTSxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQTtTQUMvRDtRQUFDLE1BQU07WUFDUCxPQUFPLENBQUMsS0FBSyxDQUFDLGVBQWUsRUFBRSxNQUFNLENBQUMsQ0FBQTtZQUN6QyxPQUFPLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUE7U0FDakQ7UUFDRSxPQUFPLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUE7SUFDOUMsQ0FBQztJQUVNLEtBQUssQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUF1QjtRQUN4RCxNQUFNLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUE7UUFDOUIsT0FBTyxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFBO0lBQ25ELENBQUM7Q0FDSDtBQXJCRCxpQ0FxQkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEh0dHBDb250ZXh0Q29udHJhY3QgfSBmcm9tICdAaW9jOkFkb25pcy9Db3JlL0h0dHBDb250ZXh0J1xuaW1wb3J0IExvZ2luVmFsaWRhdG9yIGZyb20gJ0FwcC9WYWxpZGF0b3JzL0xvZ2luVmFsaWRhdG9yJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBdXRoQ29udHJvbGxlciB7XG5cdHB1YmxpYyBhc3luYyBjcmVhdGUoeyB2aWV3IH06IEh0dHBDb250ZXh0Q29udHJhY3QpIHtcblx0XHRyZXR1cm4gdmlldy5yZW5kZXIoJ2F1dGgvY3JlYXRlJylcblx0fVxuXG5cdHB1YmxpYyBhc3luYyBzdG9yZSh7IGF1dGgsIHJlc3BvbnNlLCByZXF1ZXN0LCBzZXNzaW9uIH06IEh0dHBDb250ZXh0Q29udHJhY3QpIHtcblx0ICAgIGNvbnN0IHBheWxvYWQgPSBhd2FpdCByZXF1ZXN0LnZhbGlkYXRlKExvZ2luVmFsaWRhdG9yKVxuXG5cdCAgICB0cnkge1xuXHQgICAgICBhd2FpdCBhdXRoLnVzZSgnd2ViJykuYXR0ZW1wdChwYXlsb2FkLmVtYWlsLCBwYXlsb2FkLnBhc3N3b3JkKVxuXHQgICAgfSBjYXRjaCB7XG5cdCAgICBcdHNlc3Npb24uZmxhc2goJ0Vycm8gZGUgbG9naW4nLCAnZXJybycpXG5cdFx0XHRyZXR1cm4gcmVzcG9uc2UucmVkaXJlY3QoKS50b1JvdXRlKCdhdXRoLmNyZWF0ZScpXG5cdFx0fVxuXHQgICAgcmV0dXJuIHJlc3BvbnNlLnJlZGlyZWN0KCkudG9Sb3V0ZSgnaG9tZScpXG5cdH1cblxuXHRwdWJsaWMgYXN5bmMgZGVzdHJveSh7IGF1dGgsIHJlc3BvbnNlIH06IEh0dHBDb250ZXh0Q29udHJhY3QpIHtcblx0ICAgIGF3YWl0IGF1dGgudXNlKCd3ZWInKS5sb2dvdXQoKVxuXHQgICAgcmV0dXJuIHJlc3BvbnNlLnJlZGlyZWN0KCkudG9Sb3V0ZSgnYXV0aC5jcmVhdGUnKVxuICBcdH1cbn1cbiJdfQ==